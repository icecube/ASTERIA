import unittest
import numpy as np

import astropy.units as u
import asteria.interactions as interactions

from snewpy.neutrino import Flavor

class TestInteractions(unittest.TestCase):

    def setUp(self):
        # Create a list of interactions for use later.
        self.interactions = interactions.Interactions()
        self.Enu = np.arange(0, 101, 1) * u.MeV

        # Tabulated cross sections for each interaction and flavor.
        self.xsections = {
            interactions.ElectronScatter:
            {Flavor.NU_E: np.array([2.46031438e-63, 6.24207234e-44, 1.42478072e-43, 2.24236776e-43,
                    3.06513506e-43, 3.89015714e-43, 4.71636229e-43, 5.54326508e-43,
                    6.37061369e-43, 7.19826448e-43, 8.02612952e-43, 8.85415200e-43,
                    9.68229355e-43, 1.05105273e-42, 1.13388340e-42, 1.21671993e-42,
                    1.29956124e-42, 1.38240651e-42, 1.46525508e-42, 1.54810645e-42,
                    1.63096019e-42, 1.71381598e-42, 1.79667354e-42, 1.87953265e-42,
                    1.96239310e-42, 2.04525475e-42, 2.12811745e-42, 2.21098110e-42,
                    2.29384558e-42, 2.37671082e-42, 2.45957674e-42, 2.54244327e-42,
                    2.62531036e-42, 2.70817795e-42, 2.79104601e-42, 2.87391450e-42,
                    2.95678337e-42, 3.03965260e-42, 3.12252215e-42, 3.20539202e-42,
                    3.28826216e-42, 3.37113257e-42, 3.45400321e-42, 3.53687409e-42,
                    3.61974517e-42, 3.70261645e-42, 3.78548792e-42, 3.86835955e-42,
                    3.95123135e-42, 4.03410330e-42, 4.11697540e-42, 4.19984762e-42,
                    4.28271998e-42, 4.36559245e-42, 4.44846503e-42, 4.53133773e-42,
                    4.61421052e-42, 4.69708341e-42, 4.77995639e-42, 4.86282946e-42,
                    4.94570260e-42, 5.02857583e-42, 5.11144913e-42, 5.19432250e-42,
                    5.27719594e-42, 5.36006944e-42, 5.44294301e-42, 5.52581663e-42,
                    5.60869031e-42, 5.69156404e-42, 5.77443783e-42, 5.85731166e-42,
                    5.94018554e-42, 6.02305946e-42, 6.10593343e-42, 6.18880744e-42,
                    6.27168149e-42, 6.35455558e-42, 6.43742971e-42, 6.52030387e-42,
                    6.60317807e-42, 6.68605230e-42, 6.76892656e-42, 6.85180085e-42,
                    6.93467517e-42, 7.01754952e-42, 7.10042389e-42, 7.18329830e-42,
                    7.26617273e-42, 7.34904718e-42, 7.43192166e-42, 7.51479616e-42,
                    7.59767068e-42, 7.68054523e-42, 7.76341980e-42, 7.84629438e-42,
                    7.92916899e-42, 8.01204362e-42, 8.09491826e-42, 8.17779292e-42,
                    8.26066760e-42]),
             Flavor.NU_X: np.array([1.10285562e-63, 1.27927758e-44, 2.64289851e-44, 3.99959390e-44,
                    5.35377452e-44, 6.70678948e-44, 8.05917230e-44, 9.41117466e-44,
                    1.07629305e-43, 1.21145174e-43, 1.34659838e-43, 1.48173609e-43,
                    1.61686703e-43, 1.75199270e-43, 1.88711419e-43, 2.02223230e-43,
                    2.15734766e-43, 2.29246073e-43, 2.42757188e-43, 2.56268142e-43,
                    2.69778958e-43, 2.83289654e-43, 2.96800248e-43, 3.10310751e-43,
                    3.23821176e-43, 3.37331531e-43, 3.50841824e-43, 3.64352062e-43,
                    3.77862251e-43, 3.91372396e-43, 4.04882501e-43, 4.18392570e-43,
                    4.31902606e-43, 4.45412613e-43, 4.58922592e-43, 4.72432547e-43,
                    4.85942478e-43, 4.99452389e-43, 5.12962280e-43, 5.26472153e-43,
                    5.39982010e-43, 5.53491851e-43, 5.67001678e-43, 5.80511492e-43,
                    5.94021293e-43, 6.07531083e-43, 6.21040862e-43, 6.34550630e-43,
                    6.48060389e-43, 6.61570140e-43, 6.75079881e-43, 6.88589615e-43,
                    7.02099342e-43, 7.15609061e-43, 7.29118774e-43, 7.42628480e-43,
                    7.56138180e-43, 7.69647875e-43, 7.83157564e-43, 7.96667249e-43,
                    8.10176928e-43, 8.23686603e-43, 8.37196273e-43, 8.50705939e-43,
                    8.64215602e-43, 8.77725260e-43, 8.91234915e-43, 9.04744566e-43,
                    9.18254214e-43, 9.31763859e-43, 9.45273501e-43, 9.58783140e-43,
                    9.72292776e-43, 9.85802409e-43, 9.99312040e-43, 1.01282167e-42,
                    1.02633129e-42, 1.03984092e-42, 1.05335054e-42, 1.06686016e-42,
                    1.08036978e-42, 1.09387939e-42, 1.10738901e-42, 1.12089862e-42,
                    1.13440823e-42, 1.14791784e-42, 1.16142744e-42, 1.17493705e-42,
                    1.18844665e-42, 1.20195625e-42, 1.21546585e-42, 1.22897545e-42,
                    1.24248505e-42, 1.25599465e-42, 1.26950424e-42, 1.28301384e-42,
                    1.29652343e-42, 1.31003302e-42, 1.32354261e-42, 1.33705220e-42,
                    1.35056179e-42]),
             Flavor.NU_E_BAR: np.array([2.46031438e-63, 2.87854863e-44, 6.25176785e-44, 9.68311713e-44,
                    1.31340096e-43, 1.65938004e-43, 2.00583837e-43, 2.35258419e-43,
                    2.69951597e-43, 3.04657497e-43, 3.39372479e-43, 3.74094174e-43,
                    4.08820968e-43, 4.43551728e-43, 4.78285633e-43, 5.13022073e-43,
                    5.47760587e-43, 5.82500820e-43, 6.17242492e-43, 6.51985382e-43,
                    6.86729312e-43, 7.21474135e-43, 7.56219734e-43, 7.90966009e-43,
                    8.25712878e-43, 8.60460269e-43, 8.95208125e-43, 9.29956394e-43,
                    9.64705033e-43, 9.99454005e-43, 1.03420328e-42, 1.06895282e-42,
                    1.10370261e-42, 1.13845262e-42, 1.17320283e-42, 1.20795324e-42,
                    1.24270381e-42, 1.27745455e-42, 1.31220543e-42, 1.34695644e-42,
                    1.38170758e-42, 1.41645883e-42, 1.45121020e-42, 1.48596166e-42,
                    1.52071321e-42, 1.55546485e-42, 1.59021658e-42, 1.62496838e-42,
                    1.65972025e-42, 1.69447219e-42, 1.72922419e-42, 1.76397625e-42,
                    1.79872837e-42, 1.83348054e-42, 1.86823277e-42, 1.90298504e-42,
                    1.93773735e-42, 1.97248971e-42, 2.00724210e-42, 2.04199454e-42,
                    2.07674701e-42, 2.11149952e-42, 2.14625206e-42, 2.18100463e-42,
                    2.21575723e-42, 2.25050986e-42, 2.28526251e-42, 2.32001520e-42,
                    2.35476791e-42, 2.38952064e-42, 2.42427339e-42, 2.45902617e-42,
                    2.49377897e-42, 2.52853178e-42, 2.56328462e-42, 2.59803748e-42,
                    2.63279035e-42, 2.66754324e-42, 2.70229615e-42, 2.73704907e-42,
                    2.77180201e-42, 2.80655496e-42, 2.84130793e-42, 2.87606091e-42,
                    2.91081390e-42, 2.94556691e-42, 2.98031993e-42, 3.01507296e-42,
                    3.04982600e-42, 3.08457906e-42, 3.11933212e-42, 3.15408519e-42,
                    3.18883828e-42, 3.22359137e-42, 3.25834448e-42, 3.29309759e-42,
                    3.32785071e-42, 3.36260384e-42, 3.39735698e-42, 3.43211013e-42,
                    3.46686328e-42]),
             Flavor.NU_X_BAR: np.array([1.10285562e-63, 1.14801334e-44, 2.33084660e-44, 3.50238321e-44,
                    4.67014611e-44, 5.83621066e-44, 7.00136840e-44, 8.16598562e-44,
                    9.33025486e-44, 1.04942870e-43, 1.16581503e-43, 1.28218893e-43,
                    1.39855338e-43, 1.51491052e-43, 1.63126185e-43, 1.74760852e-43,
                    1.86395137e-43, 1.98029106e-43, 2.09662811e-43, 2.21296292e-43,
                    2.32929583e-43, 2.44562710e-43, 2.56195695e-43, 2.67828557e-43,
                    2.79461310e-43, 2.91093967e-43, 3.02726539e-43, 3.14359036e-43,
                    3.25991466e-43, 3.37623834e-43, 3.49256148e-43, 3.60888413e-43,
                    3.72520632e-43, 3.84152811e-43, 3.95784953e-43, 4.07417060e-43,
                    4.19049136e-43, 4.30681184e-43, 4.42313204e-43, 4.53945201e-43,
                    4.65577174e-43, 4.77209127e-43, 4.88841059e-43, 5.00472974e-43,
                    5.12104872e-43, 5.23736754e-43, 5.35368621e-43, 5.47000474e-43,
                    5.58632314e-43, 5.70264142e-43, 5.81895958e-43, 5.93527764e-43,
                    6.05159559e-43, 6.16791344e-43, 6.28423121e-43, 6.40054889e-43,
                    6.51686649e-43, 6.63318401e-43, 6.74950145e-43, 6.86581883e-43,
                    6.98213614e-43, 7.09845339e-43, 7.21477057e-43, 7.33108770e-43,
                    7.44740478e-43, 7.56372180e-43, 7.68003878e-43, 7.79635570e-43,
                    7.91267259e-43, 8.02898942e-43, 8.14530622e-43, 8.26162298e-43,
                    8.37793970e-43, 8.49425638e-43, 8.61057303e-43, 8.72688964e-43,
                    8.84320622e-43, 8.95952277e-43, 9.07583929e-43, 9.19215578e-43,
                    9.30847224e-43, 9.42478868e-43, 9.54110509e-43, 9.65742148e-43,
                    9.77373784e-43, 9.89005418e-43, 1.00063705e-42, 1.01226868e-42,
                    1.02390031e-42, 1.03553193e-42, 1.04716356e-42, 1.05879518e-42,
                    1.07042680e-42, 1.08205842e-42, 1.09369003e-42, 1.10532165e-42,
                    1.11695326e-42, 1.12858487e-42, 1.14021648e-42, 1.15184809e-42,
                    1.16347970e-42])
            },

            interactions.InvBetaPar :
            {Flavor.NU_E: np.zeros_like(self.Enu.value),
             Flavor.NU_X: np.zeros_like(self.Enu.value),
             Flavor.NU_X_BAR: np.zeros_like(self.Enu.value),
             Flavor.NU_E_BAR: np.array([0.00000000e+00, 0.00000000e+00, 6.63047007e-44, 5.25543954e-43,
                    1.34662836e-42, 2.52651482e-42, 4.05854349e-42, 5.93528212e-42,
                    8.14882182e-42, 1.06909730e-41, 1.35534064e-41, 1.67277531e-41,
                    2.02056758e-41, 2.39789185e-41, 2.80393415e-41, 3.23789462e-41,
                    3.69898913e-41, 4.18645045e-41, 4.69952887e-41, 5.23749265e-41,
                    5.79962818e-41, 6.38523992e-41, 6.99365032e-41, 7.62419960e-41,
                    8.27624543e-41, 8.94916260e-41, 9.64234266e-41, 1.03551935e-40,
                    1.10871390e-40, 1.18376186e-40, 1.26060866e-40, 1.33920123e-40,
                    1.41948791e-40, 1.50141842e-40, 1.58494385e-40, 1.67001655e-40,
                    1.75659017e-40, 1.84461958e-40, 1.93406084e-40, 2.02487116e-40,
                    2.11700887e-40, 2.21043339e-40, 2.30510520e-40, 2.40098579e-40,
                    2.49803765e-40, 2.59622422e-40, 2.69550989e-40, 2.79585996e-40,
                    2.89724058e-40, 2.99961877e-40, 3.10296240e-40, 3.20724011e-40,
                    3.31242135e-40, 3.41847630e-40, 3.52537591e-40, 3.63309181e-40,
                    3.74159637e-40, 3.85086259e-40, 3.96086416e-40, 4.07157540e-40,
                    4.18297126e-40, 4.29502727e-40, 4.40771957e-40, 4.52102487e-40,
                    4.63492043e-40, 4.74938406e-40, 4.86439408e-40, 4.97992935e-40,
                    5.09596921e-40, 5.21249348e-40, 5.32948247e-40, 5.44691696e-40,
                    5.56477814e-40, 5.68304769e-40, 5.80170766e-40, 5.92074058e-40,
                    6.04012932e-40, 6.15985719e-40, 6.27990786e-40, 6.40026540e-40,
                    6.52091423e-40, 6.64183911e-40, 6.76302519e-40, 6.88445792e-40,
                    7.00612310e-40, 7.12800685e-40, 7.25009562e-40, 7.37237613e-40,
                    7.49483544e-40, 7.61746088e-40, 7.74024008e-40, 7.86316094e-40,
                    7.98621163e-40, 8.10938060e-40, 8.23265655e-40, 8.35602843e-40,
                    8.47948546e-40, 8.60301707e-40, 8.72661295e-40, 8.85026303e-40,
                    8.97395743e-40])
            },

            interactions.Oxygen16CC:
            {Flavor.NU_E: np.array([0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                    0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                    0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                    0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                    5.07653159e-49, 2.82706986e-47, 2.81995937e-46, 1.39553361e-45,
                    4.71352324e-45, 1.25216878e-44, 2.82154525e-44, 5.64086645e-44,
                    1.02991013e-43, 1.75144423e-43, 2.81328155e-43, 4.31240981e-43,
                    6.35767268e-43, 9.06912384e-43, 1.25773156e-42, 1.70225539e-42,
                    2.25541429e-42, 2.93296358e-42, 3.75141051e-42, 4.72794386e-42,
                    5.88036689e-42, 7.22703380e-42, 8.78678990e-42, 1.05789156e-41,
                    1.26230742e-41, 1.49392633e-41, 1.75477694e-41, 2.04691270e-41,
                    2.37240790e-41, 2.73335424e-41, 3.13185746e-41, 3.57003442e-41,
                    4.05001031e-41, 4.57391613e-41, 5.14388640e-41, 5.76205701e-41,
                    6.43056336e-41, 7.15153852e-41, 7.92711169e-41, 8.75940673e-41,
                    9.65054081e-41, 1.06026232e-40, 1.16177544e-40, 1.26980246e-40,
                    1.38455134e-40, 1.50622888e-40, 1.63504064e-40, 1.77119087e-40,
                    1.91488248e-40, 2.06631695e-40, 2.22569433e-40, 2.39321316e-40,
                    2.56907046e-40, 2.75346167e-40, 2.94658069e-40, 3.14861975e-40,
                    3.35976951e-40, 3.58021894e-40, 3.81015538e-40, 4.04976450e-40,
                    4.29923029e-40, 4.55873505e-40, 4.82845940e-40, 5.10858230e-40,
                    5.39928099e-40, 5.70073104e-40, 6.01310633e-40, 6.33657907e-40,
                    6.67131981e-40, 7.01749742e-40, 7.37527910e-40, 7.74483044e-40,
                    8.12631535e-40, 8.51989614e-40, 8.92573350e-40, 9.34398648e-40,
                    9.77481258e-40, 1.02183677e-39, 1.06748061e-39, 1.11442807e-39,
                    1.16269425e-39, 1.21229414e-39, 1.26324255e-39, 1.31555415e-39,
                    1.36924346e-39]),
             Flavor.NU_X: np.zeros_like(self.Enu.value),
             Flavor.NU_E_BAR: np.array([0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                    0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                    0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                    2.66289690e-46, 1.10563128e-45, 3.36695541e-45, 8.35048367e-45,
                    1.79079397e-44, 3.44727907e-44, 6.10656343e-44, 1.01281563e-43,
                    1.59265253e-43, 2.39678260e-43, 3.47661859e-43, 4.88797821e-43,
                    6.69068814e-43, 8.94819559e-43, 1.17271948e-42, 1.50972730e-42,
                    1.91305785e-42, 2.39015122e-42, 2.94864415e-42, 3.59634385e-42,
                    4.34120386e-42, 5.19130210e-42, 6.15482086e-42, 7.24002851e-42,
                    8.45526302e-42, 9.80891692e-42, 1.13094238e-41, 1.29652459e-41,
                    1.47848632e-41, 1.67767634e-41, 1.89494328e-41, 2.08879608e-41,
                    2.34478823e-41, 2.61923421e-41, 2.91251236e-41, 3.22497872e-41,
                    3.55696829e-41, 3.90879603e-41, 4.28075796e-41, 4.67313213e-41,
                    5.08617958e-41, 5.52014522e-41, 5.97525871e-41, 6.45173523e-41,
                    6.94977630e-41, 7.46957043e-41, 8.01129387e-41, 8.57511122e-41,
                    9.16117605e-41, 9.76963151e-41, 1.04006108e-40, 1.10542377e-40,
                    1.17306273e-40, 1.24298860e-40, 1.31521122e-40, 1.38973969e-40,
                    1.46658238e-40, 1.54574697e-40, 1.62724051e-40, 1.71106940e-40,
                    1.79723950e-40, 1.88575607e-40, 1.97662389e-40, 2.06984718e-40,
                    2.16542975e-40, 2.26337491e-40, 2.36368556e-40, 2.46636418e-40,
                    2.57141289e-40, 2.67883340e-40, 2.78862710e-40, 2.90079504e-40,
                    3.01533794e-40, 3.13225624e-40, 3.25155008e-40, 3.37321933e-40,
                    3.49726359e-40, 3.62368224e-40, 3.75247440e-40, 3.88363897e-40,
                    4.01717466e-40, 4.15307995e-40, 4.29135314e-40, 4.43199236e-40,
                    4.57499554e-40, 4.72036047e-40, 4.86808477e-40, 5.01816592e-40,
                    5.17060124e-40]),
             Flavor.NU_X_BAR: np.zeros_like(self.Enu.value)
            },

            interactions.Oxygen16NC:
            {Flavor.NU_E: np.array([0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                    0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                    0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                    0.00000000e+00, 1.01882307e-49, 9.94773104e-48, 1.15405157e-46,
                    6.05222318e-46, 2.09237387e-45, 5.59877119e-45, 1.26013066e-44,
                    2.50464720e-44, 4.53422581e-44, 7.63349272e-44, 1.21276544e-43,
                    1.83787554e-43, 2.67817389e-43, 3.77605114e-43, 5.17641406e-43,
                    6.92632641e-43, 9.07467532e-43, 1.16718651e-42, 1.47695389e-42,
                    1.84203272e-42, 2.26776224e-42, 2.75953776e-42, 3.32279275e-42,
                    3.96298298e-42, 4.68557256e-42, 5.49602160e-42, 6.39977544e-42,
                    7.40225523e-42, 8.50884972e-42, 9.72490814e-42, 1.10557341e-41,
                    1.25065802e-41, 1.40826436e-41, 1.57890624e-41, 1.76309121e-41,
                    1.96132029e-41, 2.17408779e-41, 2.40188111e-41, 2.64518058e-41,
                    2.90445939e-41, 3.18018347e-41, 3.47281149e-41, 3.78279478e-41,
                    4.11057735e-41, 4.45659589e-41, 4.82127978e-41, 5.20505113e-41,
                    5.60832485e-41, 6.03150868e-41, 6.47500326e-41, 6.93920221e-41,
                    7.42449220e-41, 7.93125305e-41, 8.45985779e-41, 9.01067278e-41,
                    9.58405781e-41, 1.01803662e-40, 1.07999447e-40, 1.14431341e-40,
                    1.21102688e-40, 1.28016771e-40, 1.35176815e-40, 1.42585983e-40,
                    1.50247384e-40, 1.58164068e-40, 1.66339030e-40, 1.74775211e-40,
                    1.83475496e-40, 1.92442722e-40, 2.01679669e-40, 2.11189070e-40,
                    2.20973606e-40, 2.31035912e-40, 2.41378572e-40, 2.52004125e-40,
                    2.62915064e-40, 2.74113836e-40, 2.85602844e-40, 2.97384449e-40,
                    3.09460967e-40, 3.21834674e-40, 3.34507805e-40, 3.47482554e-40,
                    3.60761076e-40, 3.74345489e-40, 3.88237870e-40, 4.02440261e-40,
                    4.16954669e-40]),
             Flavor.NU_X: np.array([0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                    0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                    0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                    0.00000000e+00, 1.01882307e-49, 9.94773104e-48, 1.15405157e-46,
                    6.05222318e-46, 2.09237387e-45, 5.59877119e-45, 1.26013066e-44,
                    2.50464720e-44, 4.53422581e-44, 7.63349272e-44, 1.21276544e-43,
                    1.83787554e-43, 2.67817389e-43, 3.77605114e-43, 5.17641406e-43,
                    6.92632641e-43, 9.07467532e-43, 1.16718651e-42, 1.47695389e-42,
                    1.84203272e-42, 2.26776224e-42, 2.75953776e-42, 3.32279275e-42,
                    3.96298298e-42, 4.68557256e-42, 5.49602160e-42, 6.39977544e-42,
                    7.40225523e-42, 8.50884972e-42, 9.72490814e-42, 1.10557341e-41,
                    1.25065802e-41, 1.40826436e-41, 1.57890624e-41, 1.76309121e-41,
                    1.96132029e-41, 2.17408779e-41, 2.40188111e-41, 2.64518058e-41,
                    2.90445939e-41, 3.18018347e-41, 3.47281149e-41, 3.78279478e-41,
                    4.11057735e-41, 4.45659589e-41, 4.82127978e-41, 5.20505113e-41,
                    5.60832485e-41, 6.03150868e-41, 6.47500326e-41, 6.93920221e-41,
                    7.42449220e-41, 7.93125305e-41, 8.45985779e-41, 9.01067278e-41,
                    9.58405781e-41, 1.01803662e-40, 1.07999447e-40, 1.14431341e-40,
                    1.21102688e-40, 1.28016771e-40, 1.35176815e-40, 1.42585983e-40,
                    1.50247384e-40, 1.58164068e-40, 1.66339030e-40, 1.74775211e-40,
                    1.83475496e-40, 1.92442722e-40, 2.01679669e-40, 2.11189070e-40,
                    2.20973606e-40, 2.31035912e-40, 2.41378572e-40, 2.52004125e-40,
                    2.62915064e-40, 2.74113836e-40, 2.85602844e-40, 2.97384449e-40,
                    3.09460967e-40, 3.21834674e-40, 3.34507805e-40, 3.47482554e-40,
                    3.60761076e-40, 3.74345489e-40, 3.88237870e-40, 4.02440261e-40,
                    4.16954669e-40]),
             Flavor.NU_E_BAR: np.array([0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                    0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                    0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                    0.00000000e+00, 1.01882307e-49, 9.94773104e-48, 1.15405157e-46,
                    6.05222318e-46, 2.09237387e-45, 5.59877119e-45, 1.26013066e-44,
                    2.50464720e-44, 4.53422581e-44, 7.63349272e-44, 1.21276544e-43,
                    1.83787554e-43, 2.67817389e-43, 3.77605114e-43, 5.17641406e-43,
                    6.92632641e-43, 9.07467532e-43, 1.16718651e-42, 1.47695389e-42,
                    1.84203272e-42, 2.26776224e-42, 2.75953776e-42, 3.32279275e-42,
                    3.96298298e-42, 4.68557256e-42, 5.49602160e-42, 6.39977544e-42,
                    7.40225523e-42, 8.50884972e-42, 9.72490814e-42, 1.10557341e-41,
                    1.25065802e-41, 1.40826436e-41, 1.57890624e-41, 1.76309121e-41,
                    1.96132029e-41, 2.17408779e-41, 2.40188111e-41, 2.64518058e-41,
                    2.90445939e-41, 3.18018347e-41, 3.47281149e-41, 3.78279478e-41,
                    4.11057735e-41, 4.45659589e-41, 4.82127978e-41, 5.20505113e-41,
                    5.60832485e-41, 6.03150868e-41, 6.47500326e-41, 6.93920221e-41,
                    7.42449220e-41, 7.93125305e-41, 8.45985779e-41, 9.01067278e-41,
                    9.58405781e-41, 1.01803662e-40, 1.07999447e-40, 1.14431341e-40,
                    1.21102688e-40, 1.28016771e-40, 1.35176815e-40, 1.42585983e-40,
                    1.50247384e-40, 1.58164068e-40, 1.66339030e-40, 1.74775211e-40,
                    1.83475496e-40, 1.92442722e-40, 2.01679669e-40, 2.11189070e-40,
                    2.20973606e-40, 2.31035912e-40, 2.41378572e-40, 2.52004125e-40,
                    2.62915064e-40, 2.74113836e-40, 2.85602844e-40, 2.97384449e-40,
                    3.09460967e-40, 3.21834674e-40, 3.34507805e-40, 3.47482554e-40,
                    3.60761076e-40, 3.74345489e-40, 3.88237870e-40, 4.02440261e-40,
                    4.16954669e-40]),
             Flavor.NU_X_BAR: np.array([0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                    0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                    0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
                    0.00000000e+00, 1.01882307e-49, 9.94773104e-48, 1.15405157e-46,
                    6.05222318e-46, 2.09237387e-45, 5.59877119e-45, 1.26013066e-44,
                    2.50464720e-44, 4.53422581e-44, 7.63349272e-44, 1.21276544e-43,
                    1.83787554e-43, 2.67817389e-43, 3.77605114e-43, 5.17641406e-43,
                    6.92632641e-43, 9.07467532e-43, 1.16718651e-42, 1.47695389e-42,
                    1.84203272e-42, 2.26776224e-42, 2.75953776e-42, 3.32279275e-42,
                    3.96298298e-42, 4.68557256e-42, 5.49602160e-42, 6.39977544e-42,
                    7.40225523e-42, 8.50884972e-42, 9.72490814e-42, 1.10557341e-41,
                    1.25065802e-41, 1.40826436e-41, 1.57890624e-41, 1.76309121e-41,
                    1.96132029e-41, 2.17408779e-41, 2.40188111e-41, 2.64518058e-41,
                    2.90445939e-41, 3.18018347e-41, 3.47281149e-41, 3.78279478e-41,
                    4.11057735e-41, 4.45659589e-41, 4.82127978e-41, 5.20505113e-41,
                    5.60832485e-41, 6.03150868e-41, 6.47500326e-41, 6.93920221e-41,
                    7.42449220e-41, 7.93125305e-41, 8.45985779e-41, 9.01067278e-41,
                    9.58405781e-41, 1.01803662e-40, 1.07999447e-40, 1.14431341e-40,
                    1.21102688e-40, 1.28016771e-40, 1.35176815e-40, 1.42585983e-40,
                    1.50247384e-40, 1.58164068e-40, 1.66339030e-40, 1.74775211e-40,
                    1.83475496e-40, 1.92442722e-40, 2.01679669e-40, 2.11189070e-40,
                    2.20973606e-40, 2.31035912e-40, 2.41378572e-40, 2.52004125e-40,
                    2.62915064e-40, 2.74113836e-40, 2.85602844e-40, 2.97384449e-40,
                    3.09460967e-40, 3.21834674e-40, 3.34507805e-40, 3.47482554e-40,
                    3.60761076e-40, 3.74345489e-40, 3.88237870e-40, 4.02440261e-40,
                    4.16954669e-40])
                },
            
            interactions.Oxygen18:
            {Flavor.NU_E: np.array([0.00000e+00, 0.00000e+00, 2.98000e-45, 5.43000e-45, 8.22000e-45,
                    1.13500e-44, 1.48200e-44, 1.86300e-44, 2.27800e-44, 2.72700e-44,
                    3.21000e-44, 3.72700e-44, 4.27800e-44, 4.86300e-44, 5.48200e-44,
                    6.13500e-44, 6.82200e-44, 7.54300e-44, 8.29800e-44, 9.08700e-44,
                    9.91000e-44, 1.07670e-43, 1.16580e-43, 1.25830e-43, 1.35420e-43,
                    1.45350e-43, 1.55620e-43, 1.66230e-43, 1.77180e-43, 1.88470e-43,
                    2.00100e-43, 2.12070e-43, 2.24380e-43, 2.37030e-43, 2.50020e-43,
                    2.63350e-43, 2.77020e-43, 2.91030e-43, 3.05380e-43, 3.20070e-43,
                    3.35100e-43, 3.50470e-43, 3.66180e-43, 3.82230e-43, 3.98620e-43,
                    4.15350e-43, 4.32420e-43, 4.49830e-43, 4.67580e-43, 4.85670e-43,
                    5.04100e-43, 5.22870e-43, 5.41980e-43, 5.61430e-43, 5.81220e-43,
                    6.01350e-43, 6.21820e-43, 6.42630e-43, 6.63780e-43, 6.85270e-43,
                    7.07100e-43, 7.29270e-43, 7.51780e-43, 7.74630e-43, 7.97820e-43,
                    8.21350e-43, 8.45220e-43, 8.69430e-43, 8.93980e-43, 9.18870e-43,
                    9.44100e-43, 9.69670e-43, 9.95580e-43, 1.02183e-42, 1.04842e-42,
                    1.07535e-42, 1.10262e-42, 1.13023e-42, 1.15818e-42, 1.18647e-42,
                    1.21510e-42, 1.24407e-42, 1.27338e-42, 1.30303e-42, 1.33302e-42,
                    1.36335e-42, 1.39402e-42, 1.42503e-42, 1.45638e-42, 1.48807e-42,
                    1.52010e-42, 1.55247e-42, 1.58518e-42, 1.61823e-42, 1.65162e-42,
                    1.68535e-42, 1.71942e-42, 1.75383e-42, 1.78858e-42, 1.82367e-42,
                    1.85910e-42]),

             Flavor.NU_X: np.zeros_like(self.Enu.value),
             Flavor.NU_E_BAR: np.zeros_like(self.Enu.value),
             Flavor.NU_X_BAR: np.zeros_like(self.Enu.value)
            }
        }

        # Tabulated mean lepton energies per interaction, per flavor.
        self.mean_lepton_energy = {
            interactions.ElectronScatter:
            {Flavor.NU_E: np.array([ 0.        ,  0.16177702,  0.61223543,  1.09078596,  1.5761002 ,
                  2.06408344,  2.55339211,  3.04345507,  3.53398822,  4.02483423,
                  4.51589893,  5.00712252,  5.49846517,  5.98989934,  6.48140538,
                  6.9729689 ,  7.46457908,  7.95622769,  8.44790831,  8.93961588,
                  9.43134635,  9.92309645, 10.41486349, 10.90664527, 11.39843993,
                 11.89024594, 12.38206198, 12.87388693, 13.36571985, 13.8575599 ,
                 14.34940637, 14.84125864, 15.33311617, 15.82497848, 16.31684514,
                 16.80871578, 17.30059007, 17.79246772, 18.28434845, 18.77623204,
                 19.26811826, 19.76000693, 20.25189786, 20.74379091, 21.23568593,
                 21.72758278, 22.21948134, 22.71138151, 23.20328319, 23.69518629,
                 24.18709071, 24.67899638, 25.17090323, 25.66281119, 26.1547202 ,
                 26.64663021, 27.13854115, 27.63045298, 28.12236566, 28.61427914,
                 29.10619338, 29.59810834, 30.090024  , 30.5819403 , 31.07385723,
                 31.56577476, 32.05769286, 32.5496115 , 33.04153066, 33.53345032,
                 34.02537045, 34.51729104, 35.00921207, 35.50113351, 35.99305535,
                 36.48497758, 36.97690019, 37.46882314, 37.96074644, 38.45267007,
                 38.94459401, 39.43651826, 39.92844281, 40.42036764, 40.91229274,
                 41.4042181 , 41.89614372, 42.38806958, 42.87999568, 43.37192201,
                 43.86384857, 44.35577533, 44.84770231, 45.33962948, 45.83155685,
                 46.32348441, 46.81541214, 47.30734006, 47.79926815, 48.2911964 ,
                 48.78312481]),
          Flavor.NU_X: np.array([ 0.        ,  0.16201253,  0.58271839,  1.02370744,  1.46952928,
                  1.91725385,  2.36592191,  2.81512632,  3.26466472,  3.71442521,
                  4.16434083,  4.61436909,  5.06448173,  5.51465919,  5.96488754,
                  6.41515657,  6.86545862,  7.31578786,  7.76613974,  8.21651068,
                  8.66689781,  9.11729881,  9.56771179, 10.01813518, 10.46856768,
                 10.91900819, 11.36945578, 11.81990968, 12.27036919, 12.72083375,
                 13.17130284, 13.62177602, 14.07225292, 14.52273318, 14.97321652,
                 15.42370268, 15.8741914 , 16.3246825 , 16.77517577, 17.22567106,
                 17.67616821, 18.12666708, 18.57716755, 19.02766952, 19.47817287,
                 19.92867751, 20.37918337, 20.82969036, 21.28019841, 21.73070746,
                 22.18121745, 22.63172832, 23.08224002, 23.5327525 , 23.98326572,
                 24.43377965, 24.88429424, 25.33480945, 25.78532526, 26.23584164,
                 26.68635855, 27.13687597, 27.58739388, 28.03791224, 28.48843105,
                 28.93895028, 29.38946992, 29.83998993, 30.29051031, 30.74103104,
                 31.19155211, 31.6420735 , 32.09259519, 32.54311718, 32.99363946,
                 33.444162  , 33.89468481, 34.34520787, 34.79573116, 35.2462547 ,
                 35.69677845, 36.14730242, 36.5978266 , 37.04835097, 37.49887554,
                 37.94940029, 38.39992523, 38.85045033, 39.30097561, 39.75150104,
                 40.20202664, 40.65255238, 41.10307827, 41.5536043 , 42.00413046,
                 42.45465676, 42.90518319, 43.35570974, 43.80623642, 44.25676321,
                 44.70729011]),
          Flavor.NU_E_BAR: np.array([ 0.        ,  0.06053586,  0.30658783,  0.59166273,  0.88765611,
                  1.18820235,  1.49107681,  1.79530079,  2.1003766 ,  2.40602447,
                  2.71207502,  3.01841974,  3.32498587,  3.63172285,  3.93859438,
                  4.24557381,  4.55264105,  4.85978074,  5.16698088,  5.47423199,
                  5.78152648,  6.08885819,  6.39622207,  6.70361395,  7.01103034,
                  7.31846833,  7.62592543,  7.93339953,  8.24088881,  8.54839172,
                  8.85590689,  9.16343315,  9.47096945,  9.77851489, 10.08606867,
                 10.39363007, 10.70119846, 11.00877328, 11.31635402, 11.62394022,
                 11.93153148, 12.23912743, 12.54672773, 12.85433209, 13.16194022,
                 13.46955188, 13.77716683, 14.08478487, 14.3924058 , 14.70002945,
                 15.00765565, 15.31528426, 15.62291514, 15.93054815, 16.23818319,
                 16.54582013, 16.85345888, 17.16109934, 17.46874143, 17.77638506,
                 18.08403016, 18.39167664, 18.69932446, 19.00697354, 19.31462382,
                 19.62227525, 19.92992777, 20.23758134, 20.54523592, 20.85289145,
                 21.1605479 , 21.46820522, 21.77586339, 22.08352237, 22.39118212,
                 22.69884261, 23.00650382, 23.31416571, 23.62182826, 23.92949145,
                 24.23715525, 24.54481964, 24.85248459, 25.1601501 , 25.46781612,
                 25.77548266, 26.08314969, 26.39081719, 26.69848515, 27.00615356,
                 27.31382239, 27.62149163, 27.92916127, 28.23683131, 28.54450171,
                 28.85217248, 29.1598436 , 29.46751506, 29.77518686, 30.08285897,
                 30.39053139]),
          Flavor.NU_X_BAR: np.array([ 0.        ,  0.15213261,  0.54677314,  0.96033157,  1.37836993,
                  1.79816365,  2.21882475,  2.63997763,  3.06143614,  3.48309755,
                  3.9049005 ,  4.32680611,  4.74878855,  5.17082997,  5.59291766,
                  6.01504231,  6.43719697,  6.8593763 ,  7.28157618,  7.70379334,
                  8.12602519,  8.54826962,  8.9705249 ,  9.39278961,  9.81506257,
                 10.23734279, 10.65962943, 11.08192177, 11.5042192 , 11.92652118,
                 12.34882727, 12.77113707, 13.19345022, 13.61576642, 14.03808541,
                 14.46040693, 14.88273079, 15.30505678, 15.72738475, 16.14971453,
                 16.572046  , 16.99437903, 17.4167135 , 17.83904932, 18.26138639,
                 18.68372463, 19.10606397, 19.52840433, 19.95074565, 20.37308787,
                 20.79543094, 21.21777481, 21.64011942, 22.06246475, 22.48481074,
                 22.90715737, 23.32950459, 23.75185238, 24.17420071, 24.59654955,
                 25.01889887, 25.44124865, 25.86359887, 26.28594951, 26.70830055,
                 27.13065196, 27.55300374, 27.97535587, 28.39770832, 28.82006109,
                 29.24241417, 29.66476753, 30.08712117, 30.50947508, 30.93182924,
                 31.35418365, 31.7765383 , 32.19889317, 32.62124826, 33.04360355,
                 33.46595905, 33.88831475, 34.31067063, 34.73302669, 35.15538292,
                 35.57773932, 36.00009589, 36.42245261, 36.84480948, 37.2671665 ,
                 37.68952365, 38.11188095, 38.53423837, 38.95659593, 39.3789536 ,
                 39.8013114 , 40.22366931, 40.64602734, 41.06838547, 41.49074371,
                 41.91310205])
         },
         interactions.InvBetaPar: 
         {Flavor.NU_E: np.array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]),
          Flavor.NU_X: np.array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]),
          Flavor.NU_E_BAR: np.array([ 0.        ,  0.        ,  0.        ,  1.70047836,  2.69442864,
                  3.68627148,  4.67601355,  5.66366154,  6.64922207,  7.63270177,
                  8.61410721,  9.59344495, 10.57072152, 11.54594341, 12.5191171 ,
                 13.49024904, 14.45934565, 15.4264133 , 16.39145839, 17.35448723,
                 18.31550614, 19.27452141, 20.2315393 , 21.18656604, 22.13960784,
                 23.09067088, 24.03976132, 24.98688528, 25.93204888, 26.87525819,
                 27.81651927, 28.75583814, 29.69322082, 30.62867329, 31.56220149,
                 32.49381136, 33.42350881, 34.35129972, 35.27718995, 36.20118534,
                 37.12329169, 38.04351479, 38.9618604 , 39.87833427, 40.79294211,
                 41.70568962, 42.61658246, 43.52562628, 44.43282671, 45.33818935,
                 46.24171977, 47.14342354, 48.04330618, 48.94137321, 49.83763012,
                 50.73208238, 51.62473542, 52.51559468, 53.40466555, 54.29195342,
                 55.17746363, 56.06120154, 56.94317245, 57.82338167, 58.70183445,
                 59.57853606, 60.45349172, 61.32670665, 62.19818604, 63.06793505,
                 63.93595883, 64.80226252, 65.66685121, 66.52973001, 67.39090396,
                 68.25037813, 69.10815753, 69.96424719, 70.81865208, 71.67137717,
                 72.52242742, 73.37180775, 74.21952307, 75.06557827, 75.90997823,
                 76.7527278 , 77.59383181, 78.43329507, 79.27112239, 80.10731854,
                 80.94188828, 81.77483636, 82.60616748, 83.43588636, 84.26399768,
                 85.09050611, 85.91541629, 86.73873287, 87.56046045, 88.38060363,
                 89.19916699]),
          Flavor.NU_X_BAR: np.array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
         },
         interactions.Oxygen16CC:
         {Flavor.NU_E: np.array([ 0.   ,  0.   ,  0.   ,  0.   ,  0.   ,  0.   ,  0.   ,  0.   ,
                  0.   ,  0.   ,  0.   ,  0.   ,  0.   ,  0.   ,  0.   ,  0.   ,
                  0.   ,  0.817,  1.817,  2.817,  3.817,  4.817,  5.817,  6.817,
                  7.817,  8.817,  9.817, 10.817, 11.817, 12.817, 13.817, 14.817,
                 15.817, 16.817, 17.817, 18.817, 19.817, 20.817, 21.817, 22.817,
                 23.817, 24.817, 25.817, 26.817, 27.817, 28.817, 29.817, 30.817,
                 31.817, 32.817, 33.817, 34.817, 35.817, 36.817, 37.817, 38.817,
                 39.817, 40.817, 41.817, 42.817, 43.817, 44.817, 45.817, 46.817,
                 47.817, 48.817, 49.817, 50.817, 51.817, 52.817, 53.817, 54.817,
                 55.817, 56.817, 57.817, 58.817, 59.817, 60.817, 61.817, 62.817,
                 63.817, 64.817, 65.817, 66.817, 67.817, 68.817, 69.817, 70.817,
                 71.817, 72.817, 73.817, 74.817, 75.817, 76.817, 77.817, 78.817,
                 79.817, 80.817, 81.817, 82.817, 83.817]),
          Flavor.NU_X: np.array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]),
          Flavor.NU_E_BAR: np.array([ 0.   ,  0.   ,  0.   ,  0.   ,  0.   ,  0.   ,  0.   ,  0.   ,
                  0.   ,  0.   ,  0.   ,  0.   ,  0.   ,  0.817,  1.817,  2.817,
                  3.817,  4.817,  5.817,  6.817,  7.817,  8.817,  9.817, 10.817,
                 11.817, 12.817, 13.817, 14.817, 15.817, 16.817, 17.817, 18.817,
                 19.817, 20.817, 21.817, 22.817, 23.817, 24.817, 25.817, 26.817,
                 27.817, 28.817, 29.817, 30.817, 31.817, 32.817, 33.817, 34.817,
                 35.817, 36.817, 37.817, 38.817, 39.817, 40.817, 41.817, 42.817,
                 43.817, 44.817, 45.817, 46.817, 47.817, 48.817, 49.817, 50.817,
                 51.817, 52.817, 53.817, 54.817, 55.817, 56.817, 57.817, 58.817,
                 59.817, 60.817, 61.817, 62.817, 63.817, 64.817, 65.817, 66.817,
                 67.817, 68.817, 69.817, 70.817, 71.817, 72.817, 73.817, 74.817,
                 75.817, 76.817, 77.817, 78.817, 79.817, 80.817, 81.817, 82.817,
                 83.817, 84.817, 85.817, 86.817, 87.817]),
          Flavor.NU_X_BAR: np.array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
         },
         interactions.Oxygen16NC:
         {Flavor.NU_E: np.array([0.    , 0.    , 0.    , 0.    , 0.    , 0.    , 0.    , 0.    ,
                 0.    , 0.    , 0.    , 0.    , 0.    , 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139]),
          Flavor.NU_X: np.array([0.    , 0.    , 0.    , 0.    , 0.    , 0.    , 0.    , 0.    ,
                 0.    , 0.    , 0.    , 0.    , 0.    , 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139]),
          Flavor.NU_E_BAR: np.array([0.    , 0.    , 0.    , 0.    , 0.    , 0.    , 0.    , 0.    ,
                 0.    , 0.    , 0.    , 0.    , 0.    , 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139]),
          Flavor.NU_X_BAR: np.array([0.    , 0.    , 0.    , 0.    , 0.    , 0.    , 0.    , 0.    ,
                 0.    , 0.    , 0.    , 0.    , 0.    , 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139, 1.8139,
                 1.8139, 1.8139, 1.8139, 1.8139, 1.8139])
         },
         interactions.Oxygen18:
         {Flavor.NU_E: np.array([ 0.   ,  0.   ,  0.   ,  0.557,  1.557,  2.557,  3.557,  4.557,
                  5.557,  6.557,  7.557,  8.557,  9.557, 10.557, 11.557, 12.557,
                 13.557, 14.557, 15.557, 16.557, 17.557, 18.557, 19.557, 20.557,
                 21.557, 22.557, 23.557, 24.557, 25.557, 26.557, 27.557, 28.557,
                 29.557, 30.557, 31.557, 32.557, 33.557, 34.557, 35.557, 36.557,
                 37.557, 38.557, 39.557, 40.557, 41.557, 42.557, 43.557, 44.557,
                 45.557, 46.557, 47.557, 48.557, 49.557, 50.557, 51.557, 52.557,
                 53.557, 54.557, 55.557, 56.557, 57.557, 58.557, 59.557, 60.557,
                 61.557, 62.557, 63.557, 64.557, 65.557, 66.557, 67.557, 68.557,
                 69.557, 70.557, 71.557, 72.557, 73.557, 74.557, 75.557, 76.557,
                 77.557, 78.557, 79.557, 80.557, 81.557, 82.557, 83.557, 84.557,
                 85.557, 86.557, 87.557, 88.557, 89.557, 90.557, 91.557, 92.557,
                 93.557, 94.557, 95.557, 96.557, 97.557]),
          Flavor.NU_X: np.array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]),
          Flavor.NU_E_BAR: np.array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]),
          Flavor.NU_X_BAR: np.array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
                 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
             }
         }

        # Photon scaling factor per interaction, per flavor
        self.photon_scaling_factor = {
            interactions.ElectronScatter: {
                Flavor.NU_E: 185.29780418201466,
                Flavor.NU_X: 185.29780418201466,
                Flavor.NU_E_BAR: 185.29780418201466,
                Flavor.NU_X_BAR: 185.29780418201466
                },
            interactions.InvBetaPar: {
                Flavor.NU_E: 185.29780418201466,
                Flavor.NU_X: 185.29780418201466,
                Flavor.NU_E_BAR: 184.33936726383183,
                Flavor.NU_X_BAR: 185.29780418201466
                },
            interactions.Oxygen16CC: {
                Flavor.NU_E: 185.29780418201466,
                Flavor.NU_X: 185.29780418201466,
                Flavor.NU_E_BAR: 184.33936726383183,
                Flavor.NU_X_BAR: 185.29780418201466
                },
            interactions.Oxygen16NC: {
                Flavor.NU_E: 185.29780418201466,
                Flavor.NU_X: 185.29780418201466,
                Flavor.NU_E_BAR: 185.29780418201466,
                Flavor.NU_X_BAR: 185.29780418201466
                },
            interactions.Oxygen18: {
                Flavor.NU_E: 185.29780418201466,
                Flavor.NU_X: 185.29780418201466,
                Flavor.NU_E_BAR: 184.33936726383183,
                Flavor.NU_X_BAR: 185.29780418201466
                }
        }

    def test_interaction_list(self):
        # There should be 5 interaction types.
        self.assertTrue(len(self.interactions) == 5)

        # Check the names of the interactions:
        names = [i.__class__.__name__ for i in self.interactions]
        self.assertTrue('ElectronScatter' in names)
        self.assertTrue('InvBetaPar' in names)
        self.assertTrue('Oxygen16CC' in names)
        self.assertTrue('Oxygen16NC' in names)
        self.assertTrue('Oxygen18' in names)

    def test_cross_sections(self):
        # Test the values of the cross sections per interaction, per flavor.
        for i in self.interactions:
            for fl in Flavor:
                xs = i.cross_section(fl, self.Enu).to_value('cm2')
                xs_std = self.xsections[type(i)][fl]
                self.assertTrue(np.allclose(xs, xs_std, atol=0)) 

    def test_mean_lepton_energy(self):
        # Test the mean lepton energies per interaction, per flavor.
        for i in self.interactions:
            for fl in Flavor:
                mle = i.mean_lepton_energy(fl, self.Enu).to_value('MeV')
                mle_std = self.mean_lepton_energy[type(i)][fl]
                self.assertTrue(np.allclose(mle, mle_std, atol=0)) 

    def test_photons_dNdl(self):
        # Check the photon production per unit path length.
        dNdl = 31947.8973 # 1/m
        for i in self.interactions:
            self.assertTrue(np.allclose(dNdl, i.photons_per_path().to_value('1/m')))

    def test_photon_yield(self):
        # Check the photon production per lepton per MeV.
        dNdE = 185.2978 # 1/MeV
        for i in self.interactions:
            self.assertTrue(np.allclose(dNdE, i.photons_per_lepton_MeV.to_value('1/MeV')))

    def test_photon_scaling_factor(self):
        # Test the mean lepton energies per interaction, per flavor.
        for i in self.interactions:
            for fl in Flavor:
                psf = i.photon_scaling_factor(fl).to_value('1/MeV')
                psf_std = self.photon_scaling_factor[type(i)][fl]
                self.assertTrue(np.allclose(psf, psf_std, atol=0)) 
